/* @license
jComponent + Tangular
Copyright 2014-2015 Peter Širka All rights reserved.
Code licensed under MIT.
*/
var Thelpers={},Tangular={};Tangular.register=function(e,r){Thelpers[e]=r},Tangular.compile=function(e){e||(e="");for(var r=-1,n=[],i=-1,t=0,s=e.length,u=0;s>r++;){var a=e.substring(r,r+2);if(-1===i)if("{{"!==a);else{if(-1!==i){u++;continue}var l=e.substring(t,r);n.push(l?'unescape("'+escape(l)+'")':'""'),i=r+2}else if("}}"===a){if(u>0){u--;continue}n.push(e.substring(i,r).trim()),t=r+2,i=-1;continue}}n.push('unescape("'+escape(e.substring(t,s))+'")'),s=n.length;for(var f="$output+=",g='var $s=this;var $output="";',o=[],c=!1,p=0,d=0;s>d;d++)if(d%2!==0){var h=n[d],v=!1,r=h.lastIndexOf("|"),b="helpers.encode(@)",T=null,$=h.substring(0,3);"if "===$&&(h="if( "+h.substring(3)+"){",v=!0),"foreach "===h.substring(0,8)&&(T=h.split(" "),"var"===T[1]&&T.splice(1,1),o.push(T[1]),v=!0,c=!0,p++);var m=h.substring(0,5);if("endif"===m||"fi"===h?(h="}",v=!0):"else"===m?(h="} else {",v=!0):("end"===$||"endfor"===h.substring(0,6))&&(h=0===o.length?"}":"}})();",o.pop(),v=!0,p--,0===p&&(c=!1)),v)h=Tangular.append(h,o,c).trim();else{if(-1!==r){b=h.substring(r+1).trim(),h=h.substring(0,r),r=b.indexOf("(");var x=b;if(-1===r?b+="(@)":(x=b.substring(0,r),b=b.substring(0,r+1)+"@"+(-1===b.indexOf("()")?",":"")+b.substring(r+1)),b="helpers."+b,void 0===Thelpers[x])throw new Error('Helper: "'+x+'" not found.')}r=b.indexOf("("),b=b.substring(0,r)+".call($s,"+b.substring(r+1),h=b.replace("@",Tangular.append(h,o,c).trim())}if(v){if(T){var w=Tangular.append(T[3],o,c);h="if ("+w+"===null||"+w+"===undefined)"+w+"=[];(function(){for(var i=0,length="+w+".length;i<length;i++){var "+T[1]+"="+w+"[i];var $index=i;"}g+=h}else g+=f+h+";"}else g+=f+n[d]+";";return function(e){return new Function("helpers",g+";return $output;").call(e,Thelpers)}},Tangular.append=function(e,r){return void 0===r&&(r=[]),e.replace(/[\_\$a-zá-žÁ-ŽA-Z0-9\s]+/g,function(e,n,i){var t=i.substring(n-1,n),s=!1,u=e.trim();switch(('"'===t||"'"===t||"."===t)&&(s=!0),e.trim()){case"else":case"end":case"endfor":case"endif":case"fi":case"foreach":case"if":return e;case"$index":if(!s)return e}if(""===u)return"";if(s)return e;s=!1;for(var a=0,l=r.length;l>a;a++){var f=r[a].length;if(u.substring(0,f)===r[a]){if(u.length!==f){var t=u.substring(f,f+1);if("."!==t&&"+"!==t)continue}s=!0;break}}if(s)return u;t=u.substring(0,1);var g=t.charCodeAt(0);return g>47&&58>g?u:"$s."+u})},Tangular.render=function(e,r){return(void 0===r||null===r)&&(r={}),"string"==typeof e&&(e=Tangular.compile(e)),e(r)},Tangular.register("encode",function(e){return(void 0===e||null===e)&&(e=""),e.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(e){return(void 0===e||null===e)&&(e=""),e});
function $components_url(t){var e=t.indexOf("?"),n=[];return $.components.$version&&n.push("version="+encodeURIComponent($.components.$version)),$.components.$language&&n.push("language="+encodeURIComponent($.components.$language)),0===n.length?t:(t+=-1!==e?"&":"?",t+n.join("&"))}function $components_ready(){clearTimeout($cmanager.timeout),$cmanager.timeout=setTimeout(function(){$cmanager.initialize();var t=$cmanager.components.length;if($(document).trigger("components",[t]),$cmanager.isReady||($cmanager.clear("valid","dirty"),$cmanager.isReady=!0,$.components.emit("init"),$.components.emit("ready")),$cmanager.isCompiling=!1,$cmanager.ready){for(var e=$cmanager.ready,n=0,o=e.length;o>n;n++)e[n](t);delete $cmanager.ready}},100)}function component_init(t,e){var n,o=t.get(0).tagName;$.components.debug&&console.log("%c$.components.init: "+e.name+" ("+(e.id||e._id)+")","color:green"),"INPUT"===o||"SELECT"===o||"TEXTAREA"===o?(e.$input=!0,n=e.element):n=t.find(COM_DATA_BIND_SELECTOR),n.each(function(){this.$component||(this.$component=e)}),$cmanager.components.push(e),$cmanager.init.push(e),$.components.compile(t),$components_ready()}function Component(t){this._id="component"+Math.floor(1e5*Math.random()),this.$dirty=!0,this.$valid=!0,this.$validate=!1,this.$parser=[],this.$formatter=[],this.$skip=!1,this.$ready=!1,this.$path,this.name=t,this.path,this.type,this.id,this.make,this.done,this.prerender,this.destroy,this.state,this.validate,this.getter=function(t,e,n){return t=this.parser(t),2===e&&(this.$skip=!0),t!==this.get()||2===e&&null===n?(this.set(this.path,t,e),this):this},this.setter=function(t,e){var n=this;if(2===e&&n.$skip===!0)return n.$skip=!1,n;var o=n.$input===!0?this.element:this.element.find(COM_DATA_BIND_SELECTOR);t=n.formatter(t),o.each(function(){var e=this.$component.path;if(!(e&&e.length>0&&e!==n.path)){if("checkbox"===this.type){var o=null!==t&&void 0!==t?t.toString().toLowerCase():"";return void(this.checked="true"===o||"1"===o||"on"===o)}return(void 0===t||null===t)&&(t=""),"select-one"===this.type||"select"===this.type?void $(this).val(t):void(this.value=t)}})},this.$parser.push(function(t,e,n){if("number"===n||"currency"===n||"float"===n){"string"==typeof e&&(e=e.replace(/\s/g,"").replace(/,/g,"."));var o=parseFloat(e);return isNaN(o)&&(o=null),o}return e})}function component(t,e){return COMPONENT(t,e)}function COMPONENT(t,e){var n=function(n){var o=new Component(t);return o.element=n,o.setPath(n.attr(COM_ATTR_P)||o._id),e.call(o),o};$cmanager.register[t]=n}function component_async(t,e,n){var o=t.shift();return void 0===o?void(n&&n()):void e(o,function(){component_async(t,e,n)})}function ComponentManager(){this.isReady=!1,this.isCompiling=!1,this.init=[],this.register={},this.cache={},this.cacherest={},this.temp={},this.model={},this.components=[],this.schemas={},this.toggle=[],this.ready=[],this.events={},this.timeout,this.pending=[],this.timeoutStyles,this.styles=[],this.operations={}}function SET(t,e,n,o){return"boolean"==typeof n?$.components.set(t,e,n):n?void setTimeout(function(){$.components.set(t,e,o)},n):$.components.set(t,e,o)}function EXTEND(t,e,n,o){return"boolean"==typeof n?$.components.extend(t,e,n):n?void setTimeout(function(){$.components.extend(t,e,o)},n):$.components.extend(t,e,o)}function PUSH(t,e,n,o){return"boolean"==typeof n?$.components.push(t,e,n):n?void setTimeout(function(){$.components.push(t,e,o)},n):$.components.push(t,e,o)}function RESET(t,e){return $.components.reset(t,e)}function WATCH(t,e,n){return $.components.on("watch",t,e,n)}function GET(t){return $.components.get(t)}function UPDATE(t,e,n){return"boolean"==typeof e?$.components.update(t,e):e?void setTimeout(function(){$.components.update(t,n)},e):$.components.update(t,n)}function CHANGE(t,e){return $.components.change(t,e)}function INJECT(t,e,n,o){return $.components.inject(t,e,n,o)}function SCHEMA(t,e,n){return $.components.schema(t,e,n)}function OPERATION(t,e){return e?($cmanager.operations[t]=e,e):35===t.charCodeAt(0)?$cmanager.operations[t.substring(1)]:$cmanager.operations[t]}function EVALUATE(t,e){return $.components.evaluate(t,e)}function STYLE(t){clearTimeout($cmanager.timeoutStyles),$cmanager.styles.push(t),$cmanager.timeoutStyles=setTimeout(function(){$('<style type="text/css">'+$cmanager.styles.join("")+"</style>").appendTo("head"),$cmanager.styles=[]},50)}var $cmanager=new ComponentManager,COM_DATA_BIND_SELECTOR="input[data-component-bind],textarea[data-component-bind],select[data-component-bind]",COM_ATTR="[data-component]",COM_ATTR_U="data-component-url",COM_ATTR_URL="["+COM_ATTR_U+"]",COM_ATTR_B="data-component-bind",COM_ATTR_P="data-component-path",COM_ATTR_T="data-component-template",COM_ATTR_I="data-component-init",COM_ATTR_C="data-component-class";$.fn.component=function(){return this.data(COM_ATTR)},$.components=function(t){return $cmanager.isCompiling?$.components:$.components.compile(t)},$.components.evaluate=function(t,e){var n="eval"+e,o=$cmanager.cache[n],r=$.components.get(t);return $.components.debug&&console.log("%c$.components.evaluate("+t+")","color:gray"),void 0!==o?o.call(r,r,t):(-1===e.indexOf("return")&&(e="return "+e),o=new Function("value","path",e),$cmanager.cache[n]=o,o.call(r,r,t))},$.components.defaults={},$.components.defaults.delay=300,$.components.defaults.keypress=!0,$.components.defaults.timeout=15,$.components.debug=!1,$.components.version="v1.8.0",$.components.$version="",$.components.$language="",$.components.$formatter=[],$.components.$parser=[],$.components.compile=function(t){if($cmanager.isCompiling=!0,$.components.$inject(),$cmanager.pending.length>0)return $cmanager.pending.push(function(){$.components.compile(t)}),$.components;var e=t?t.find(COM_ATTR):$(COM_ATTR),n=!1;return e.each(function(){if(!n){var t=$(this),e=t.attr("data-component");if(!t.data(COM_ATTR)){var o=$cmanager.register[e||""];if(o){var r=o(t);r.$init=t.attr(COM_ATTR_I)||null,r.type=t.attr("data-component-type")||"",t.data(COM_ATTR,r);var a=t.attr(COM_ATTR_T)||r.template;if(a&&(r.template=a),t.attr(COM_ATTR_U))throw new Error("You cannot use [data-component-url] for the component: "+r.name+"["+r.path+"]. Instead of it you must use data-component-template.");if("string"==typeof a){var i=function(e){r.prerender&&(e=prerender(e)),"function"==typeof r.make&&r.make(e),component_init(t,r)},c=a.substring(0,1);return void("."===c||"#"===c||"["===c?i($(c).html()):$.get($components_url(a),i))}if("string"==typeof r.make)return-1!==r.make.indexOf("<")?(r.prerender&&(r.make=r.prerender(r.make)),t.html(r.make),void component_init(t,r)):void $.get($components_url(r.make),function(e){r.prerender&&(e=prerender(e)),t.html(e),component_init(t,r)});r.make&&r.make()&&(n=!0),component_init(t,r)}}}}),n?void $.components.compile():void 0!==t?void $cmanager.next():0===$cmanager.toggle.length?void $cmanager.next():void component_async($cmanager.toggle,function(t,e){for(var n=0,o=t.toggle.length;o>n;n++)t.element.toggleClass(t.toggle[n]);e()},function(){$cmanager.next()})},$.components.$inject=function(){var t=$(COM_ATTR_URL),e=[],n=0;t.each(function(){var t=$(this);t.data(COM_ATTR_URL)||(t.data(COM_ATTR_URL,"1"),e.push({element:t,cb:t.attr(COM_ATTR_I),path:t.attr(COM_ATTR_P),url:t.attr(COM_ATTR_U),toggle:(t.attr(COM_ATTR_C)||"").split(" ")}))}),0!==e.length&&component_async(e,function(t,e){t.element.load($components_url(t.url),function(){if(t.path){var o=t.element.find(COM_ATTR);o.each(function(){var e=$(this);$.each(this.attributes,function(){this.specified&&e.attr(this.name,this.value.replace("$",t.path))})})}if(t.toggle.length>0&&""!==t.toggle[0]&&$cmanager.toggle.push(t),t.cb&&!t.element.attr("data-component")){var r=$cmanager.get(t.cb);"function"==typeof r&&r(t.element)}n++,e()})},function(){$cmanager.clear("valid","dirty"),0!==n&&$.components.compile()})},$.components.inject=function(t,e,n){"function"==typeof e&&(timeout=n,n=e,e="body"),e||(e="body");var o=t.lastIndexOf(".");if(o=-1!==o?t.substring(o).toLowerCase():"",".js"===o){var r=d.createElement("script");return r.type="text/javascript",r.async=!0,r.onload=function(){n&&n()},r.src=Url,void document.getElementsByTagName("head")[0].appendChild(r)}if(".css"===o){var a=document.createElement("link");return a.type="text/css",a.rel="stylesheet",a.href="style.css",void document.getElementsByTagName("head")[0].appendChild(a)}if("body"===e){var i=Math.floor(1e5*Math.random()),c='data-component-injector="'+i+'"';$(e).append("<div "+c+"></div>"),e=$(e).find("> div["+c+"]")}return $(e).load($components_url(t),function(){$.components.compile(),n&&n()}),$.components},$.components.parseQuery=function(t){t||(t=window.location.search),"?"===t.substring(0,1)&&(t=t.substring(1));for(var e=t.split("&"),n={},o=0,r=e.length;r>o;o++){var a=e[o].split("="),i=a[0],c=decodeURIComponent(a[1]||"");n[i]?(n[i]instanceof Array||(n[i]=[n[i]]),n[i].push(c)):n[i]=c}return n},$.components.POST=function(t,e,n,o,r){if(t||(t=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.POST("+t+")","color:magenta"),$.ajax($components_url(t),{type:"POST",data:JSON.stringify(e),success:function(t){return"string"==typeof n?$cmanager.remap(n,t):void(n&&n(t))},error:function(e,n,o){return $.components.emit("error",o,e.status,t),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,e.status,n))},contentType:"application/json"})},o||0),$.components},$.components.PUT=function(t,e,n,o,r){if(t||(t=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.PUT("+t+")","color:magenta"),$.ajax($components_url(t),{type:"PUT",data:JSON.stringify(e),success:function(t){return"string"==typeof n?$cmanager.remap(n,t):void(n&&n(t))},error:function(e,n,o){return $.components.emit("error",o,e.status,t),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,e.status,n))},contentType:"application/json"})},o||0),$.components},$.components.GET=function(t,e,n,o,r){if(t||(t=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.GET("+t+")","color:magenta"),$.ajax($components_url(t),{type:"GET",data:e,success:function(t){return"string"==typeof n?$cmanager.remap(n,t):void(n&&n(t))},error:function(e,n,o){return $.components.emit("error",o,e.status,t),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,e.status,n))}})},o||0),$.components},$.components.DELETE=function(t,e,n,o,r){if(t||(t=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.DELETE("+t+")","color:magenta"),$.ajax($components_url(t),{type:"DELETE",data:JSON.stringify(e),success:function(t){return"string"==typeof n?$cmanager.remap(n,t):void(n&&n(t))},error:function(e,n,o){if($.components.emit("error",o,e.status,t),"string"==typeof r)return $cmanager.remap(r,o);if(!r)throw new Error(o);r(o,e.status,n)},contentType:"application/json"})},o||0),$.components},$.components.GETCACHE=function(t,e,n,o,r){var a=$cmanager.restcache("GET",t,e);return void 0!==a?("string"==typeof n?$cmanager.remap(n,a):n(a),$.components):($.components.GET(t,e,function(o){$cmanager.restcache("GET",t,e,o),"string"==typeof n?$cmanager.remap(n,o):n(o)},r),o?(setTimeout(function(){$.components.DELETECACHE("GET",t,e)},o),$.components):$.components)},$.components.POSTCACHE=function(t,e,n,o){var r=$cmanager.restcache("POST",t,e);return void 0!==r?("string"==typeof n?$cmanager.remap(n,r):n(r),$.components):($.components.POST(t,e,function(o){$cmanager.restcache("POST",t,e,o),"string"==typeof n?$cmanager.remap(n,o):n(o)},timeout),o?(setTimeout(function(){$.components.DELETECACHE("POST",t,e)},o),$.components):$.components)},$.components.DELETECACHE=function(t,e,n){var o=t.toUpperCase()+"#"+e+(n?"?"+JSON.stringify(n):"");return delete $cmanager.cacherest[o],$.components},$.components.ready=function(t){return $cmanager.ready.push(t),$.components},$.components.watch=function(t,e,n){return $.components.on("watch",t,e),n?(setTimeout(function(){e.call($.components,t,$cmanager.get(t))},5),$.components):$.components},$.components.on=function(t,e,n,o){"function"==typeof e?(n=e,e=""):e=e.replace(".*",""),$.components.debug&&console.log("%c$.components.on("+t+(e?", "+e:"")+")","color:blue");var r=null;return 33===e.charCodeAt(0)&&(e=e.substring(1),r=e),$cmanager.events[e]?$cmanager.events[e][t]||($cmanager.events[e][t]=[]):($cmanager.events[e]={},$cmanager.events[e][t]=[]),$cmanager.events[e][t].push({fn:n,id:this._id,path:r}),o?(n.call($.components,e,$cmanager.get(e)),$.components):$.components},$.components.$emit2=function(t,e,n){var o=$cmanager.events[e];if(!o)return!1;if(o=o[t],!o)return!1;for(var r=0,a=o.length;a>r;r++){var i=o[r];i.path&&i.path!==e||i.fn.apply(i.context,n)}return!0},$.components.$emitonly=function(t,e,n,o){for(var r={},a=Object.keys(e),i=0,c=a.length;c>i;i++)for(var s=a[i].split("."),p="",m=0,u=s.length;u>m;m++)p+=(p?".":"")+s[m],r[p]=e[p];return $.components.$emit2(t,"*",[o,r[o]]),Object.keys(r).forEach(function(e){$.components.$emit2(t,e,[o,r[e]])}),this},$.components.$emit=function(t,e){if(e){for(var n=e.split("."),o=[],r="watch"===t?1:2,a=arguments.length;a>r;r++)o.push(arguments[r]);$.components.$emit2(t,"*",o);for(var i="",r=0,a=n.length;a>r;r++){var c=n[r],s=n[r];if("*"!==c){if("]"===s.substring(s.length-1,s.length)){var p=s.lastIndexOf("[");s=s.substring(0,p)}i+=r>0?".":"",o[1]=$.components.get(i+c),$.components.$emit2(t,i+c,o),c!==s&&$.components.$emit2(t,i+s,o),i+=c}}return!0}},$.components.emit=function(t){var e=$cmanager.events[""];if(!e)return!1;if(e=$cmanager.events[""][t],!e)return!1;for(var n=[],o=1,r=arguments.length;r>o;o++)n.push(arguments[o]);for(var o=0,r=e.length;r>o;o++)e[o].fn.apply(e[o].context,n);return!0},$.components.change=function(t,e){return void 0===e?!$.components.dirty(t):!$.components.dirty(t,!e)},$.components.valid=function(t,e,n){var o="valid"+t;if("boolean"!=typeof e&&void 0!==$cmanager.cache[o])return $cmanager.cache[o];$.components.debug&&console.log("%c$.components.valid("+t+")","color:orange");var r=!0,a=void 0!==e?[]:null,i=n?$.components.eachPath:$.components.each;return i(function(o){if(void 0===e)return void(o.$valid===!1&&(r=!1));var i=!0,c=!0;if(n){var s=-1!==o.path.substring(o.path.length-1);s||(i=o.path===t),c=o.path===t}else c=!0,i=!0;i&&o.state&&a.push(o),c&&(o.$valid=e,o.$validate=!1),o.$valid===!1&&(r=!1)},t),$cmanager.clear("valid"),$cmanager.cache[o]=r,$.components.state(a,1,1),r},$.components.dirty=function(t,e,n){var o="dirty"+t;if("boolean"!=typeof e&&void 0!==$cmanager.cache[o])return $cmanager.cache[o];$.components.debug&&console.log("%c$.components.dirty("+t+")","color:orange");var r=!0,a=void 0!==e?[]:null,i=n?$.components.eachPath:$.components.each;return i(function(o){if(void 0===e)return void(o.$dirty===!1&&(r=!1));var i=!0,c=!0;if(n){var s=-1!==o.path.substring(o.path.length-1);s||(i=o.path===t),c=o.path===t}else c=!0,i=!0;i&&o.state&&a.push(o),c&&(o.$dirty=e),o.$dirty===!1&&(r=!1)},t),$cmanager.clear("dirty"),$cmanager.cache[o]=r,$.components.state(a,2,2),r},$.components.update=function(t,e){t=t.replace(".*","");var n=[],o=t.length,r=!1,a={};$.components.debug&&console.log("%c$.components.update("+t+")","color:red"),$.components.each(function(i){if(!(o>0)||i.path){var c=i.path.length;if(!(i.path.substring(0,o)!==t&&t.substring(0,c)!==i.path||i.$path&&i.$path!==t)){var s=i.get();i.setter&&i.setter(s,t,1),i.$ready=!0,e===!0?(i.$dirty=!0,i.$valid=!0,i.$validate=!1,i.validate&&(i.$valid=i.validate(s))):i.validate&&i.valid(i.validate(s),!0),i.state&&n.push(i),i.path===t&&(r=!0),a[i.path]=s}}}),a[t]||(a[t]=$.components.get(t));for(var i=0,o=n.length;o>i;i++)n[i].state(1,4);return o=t.length,Object.keys($cmanager.events).forEach(function(e){e.substring(0,o)===t&&(a[e]=$.components.get(e))}),$.components.$emitonly("watch",a,1,t),$.components},$.components.extend=function(t,e,n){var o=$.components.get(t);return(null===o||void 0===o)&&(o={}),$.components.debug&&console.log("%c$.components.extend("+t+")","color:silver"),$.components.set(t,$.extend(!0,o,e),n),$.components},$.components.set=function(t,e,n){if(43===t.charCodeAt(0))return t=t.substring(1),$.components.push(t,e,n);var o="object"==typeof e&&!(e instanceof Array)&&null!==e&&void 0!==e,r=n===!0;if(r&&(n=1),$.components.debug&&!o&&console.log("%c$.components.set("+t+")","color:red"),$cmanager.set(t,e),o)return $.components.update(t,r);var a=$cmanager.get(t),i=[];void 0===n&&(n=1),$.components.each(function(e){e.$path&&e.$path!==t||(e.path===t?e.setter&&e.setter(a,t,n):e.setter&&e.setter($.components.get(e.path),t,n),e.$ready=!0,e.state&&i.push(e),r?(e.$dirty=!0,e.$valid=!0,e.$validate=!1,e.validate&&(e.$valid=e.validate(a))):e.validate&&e.valid(e.validate(a),!0))},t,!0);for(var c=0,s=i.length;s>c;c++)i[c].state(n,5);return $.components.$emit("watch",t,void 0,n),$.components},$.components.push=function(t,e,n){$.components.debug&&console.log("%c$.components.push("+t+")","color:silver");var o=$.components.get(t);o instanceof Array||(o=[]);var r=!0;return e instanceof Array?e.length>0?o.push.apply(o,e):r=!1:o.push(e),r&&$.components.update(t,n),self},$.components.clean=function(){return $cmanager.cleaner(),$.components},$.components.get=function(t){return $.components.debug&&console.log("%c$.components.get("+t+")","color:gray"),$cmanager.get(t)},$.components.remove=function(t){return $cmanager.clear(),$.components.each(function(t){t.remove(!0)},t),$cmanager.cleaner(),$.components},$.components.validate=function(t){var e=[],n=!0;return $.components.each(function(t){var o=t.path;t.state&&e.push(t),t.$validate=!0,t.validate&&(t.$valid=t.validate($cmanager.get(o)),t.$valid||(n=!1))},t),$cmanager.clear("valid"),$.components.state(e,1,1),$.components.$emit("validate",t),n},$.components.invalid=function(t){var e=[];return $.components.each(function(t){t.$valid===!1&&e.push(t)},t),e},$.components.can=function(t){return!$.components.dirty(t)&&$.components.valid(t)},$.components.disable=function(t){return $.components.dirty(t)||!$.components.valid(t)},$.components.state=function(t,e,n){t&&0!==t.length&&setTimeout(function(){for(var o=0,r=t.length;r>o;o++)t[o].state(e,n)},2)},$.components.reset=function(t,e){if(e>0)return setTimeout(function(){$.components.reset(t)},e),$.components;$.components.debug&&console.log("%c$.components.reset("+t+")","color:orange");var n=[];return $.components.each(function(t){t.state&&n.push(t),t.$dirty=!0,t.$valid=!0,t.$validate=!1,t.validate&&(t.$valid=t.validate(t.get()))},t),$cmanager.clear("valid","dirty"),$.components.state(n,1,3),$.components.$emit("reset",t),$.components},$.components.findByName=function(t,e,n){"function"==typeof e&&(n=e,e=void 0);var o,r="function"==typeof n;return $.components.each(function(e){return e.name===t?r?void n(e):(o=e,!0):void 0},e),r?$.components:o},$.components.findByPath=function(t,e){"function"==typeof t&&(e=t,t=void 0);var n,o="function"==typeof e;return $.components.each(function(t){return o?void e(t):(n=t,!0)},t),o?$.components:n},$.components.findById=function(t,e,n){"function"==typeof e&&(n=e,e=void 0);var o,r="function"==typeof n;return $.components.each(function(e){return e.id===t?r?void n(e):(o=e,!0):void 0},e),r?$.components:o},$.components.schema=function(t,e,n){if(!e)return $.extend(!0,{},$cmanager.schemas[t]);if("object"==typeof e)return $cmanager.schemas[t]=e,e;if("function"==typeof e){var o=e();return $cmanager.schemas[t]=o,o}if("string"!=typeof e)return void 0;var r=e.substring(0,1),a=e.substring(e.length-1);if('"'===r&&'"'===a||"["===r&&"]"===a||"{"===r&&"}"===a){var i=JSON.parse(e);return $cmanager.schemas[t]=i,n&&n(i),i}$.get($components_url(e),function(e){"string"==typeof e&&(e=JSON.parse(e)),$cmanager.schemas[t]=e,n&&n(e)})},$.components.each=function(t,e,n){var o=e?-1!==e.lastIndexOf("*"):!1;o&&(e=e.replace(".*","").replace("*",""));for(var r=0,a=0,i=$cmanager.components.length;i>a;a++){var c=$cmanager.components[a];if(e){if(!c.path)continue;if(o){if(0!==c.path.indexOf(e))continue}else if(e!==c.path){if(!n)continue;if(-1===e.indexOf(c.path))continue}}if(c&&!c.$removed){var s=t(c,r++,o);if(s===!0)return $.components}}return $.components},$.components.eachPath=function(t,e){var n=e?-1!==e.lastIndexOf("*"):!1;n&&(e=e.replace(".*","").replace("*",""));for(var o=0,r=0,a=$cmanager.components.length;a>r;r++){var i=$cmanager.components[r];i&&i.$removed||!i.path||(n?(0!==e.indexOf(i.path)||i.path.indexOf(e))&&t(i,o++,!0):0===e.indexOf(i.path)&&t(i,o++,!1))}return $.components},Component.prototype.setPath=function(t){var e=null;return 33===t.charCodeAt(0)&&(t=substring(1),e=t),this.path=t,this.$path=e,this},Component.prototype.attr=function(t,e){return void 0===e?this.element.attr(t):(this.element.attr(t,e),this)},Component.prototype.html=function(t){return void 0===t?this.element.html():this.element.html(t)},Component.prototype.isInvalid=function(){var t=!this.$valid;return t&&!this.$validate&&(t=!this.$dirty),t},Component.prototype.watch=function(t,e,n){var o=this;return"function"==typeof t&&(n=e,e=t,t=o.path),o.on("watch",t,e),n?(setTimeout(function(){e.call(o,t,o.get())},5),o):o},Component.prototype.invalid=function(){return this.valid(!1).dirty(!1)},Component.prototype.valid=function(t,e){return void 0===t?this.$valid:(this.$valid=t,this.$validate=!1,$cmanager.clear("valid"),e?this:(this.state&&this.state(1,1),this))},Component.prototype.style=function(t){return STYLE(t),this},Component.prototype.change=function(t){return void 0===t?!this.dirty():this.dirty(!t)},Component.prototype.dirty=function(t,e){return void 0===t?this.$dirty:(this.$dirty=t,$cmanager.clear("dirty"),e?this:(this.state&&this.state(2,2),this))},Component.prototype.remove=function(t){this.destroy&&this.destroy(),this.element.removeData(COM_ATTR),this.element.find(COM_DATA_BIND_SELECTOR).unbind("change"),this.element.remove(),t||$cmanager.clear(),$.components.$removed=!0,$.components.$emit("destroy",this.name,this.element.attr(COM_ATTR_P)),t?$cmanager.refresh():$cmanager.cleaner()},Component.prototype.on=function(t,e,n,o){"function"==typeof e?(o=n,n=e,e=this.path):e=e.replace(".*","");var r=null;return 33===e.charCodeAt(0)&&(e=e.substring(1),r=e),$cmanager.events[e]?$cmanager.events[e][t]||($cmanager.events[e][t]=[]):($cmanager.events[e]={},$cmanager.events[e][t]=[]),$cmanager.events[e][t].push({fn:n,context:this,id:this._id,path:r}),o?(n.call($.components,e,$cmanager.get(e)),this):$.components},Component.prototype.formatter=function(t,e){for(var n=e?$.components.$formatter:this.$formatter,o=0,r=n.length;r>o;o++)t=n[o].call(this,this.path,t,this.type);return t},Component.prototype.parser=function(t,e){for(var n=e?$.components.$parser:this.$parser,o=0,r=n.length;r>o;o++)t=n[o].call(this,this.path,t,this.type);return t},Component.prototype.emit=function(){$.components.emit.apply($.components,arguments)},Component.prototype.evaluate=function(t,e){return e||(t=self.path),$.components.evaluate(t,e)},Component.prototype.get=function(t){return t||(t=this.path),t?($.components.debug&&console.log("%c$.components.get("+t+")","color:gray"),$cmanager.get(t)):void 0},Component.prototype.update=function(t,e){$.components.update(t||this.path,e)},Component.prototype.set=function(t,e,n){var o=this;return void 0===e&&(e=t,t=this.path),t?($.components.set(t,e,n),o):o},Component.prototype.extend=function(t,e,n){var o=this;return void 0===e&&(e=t,t=this.path),t?($.components.extend(t,e,n),o):o},Component.prototype.push=function(t,e,n){var o=this;return void 0===e&&(e=t,t=this.path),t?void $.components.push(t,e,n,o):o},ComponentManager.prototype.restcache=function(t,e,n,o){var r=t+"#"+e+(n?"?"+JSON.stringify(n):"");return void 0===o?this.cacherest[r]:void(this.cacherest[r]=o)},ComponentManager.prototype.initialize=function(){var t=this.init.pop();return void 0===t?($.components.compile(),this):(t.$removed||this.prepare(t),this.initialize(),this)},ComponentManager.prototype.remap=function(t,e){var n=t.indexOf("->");if(-1===n)return $.components.set(t,e);var o=t.substring(0,n).trim(),r=t.substring(n+2).trim();return $.components.set(r,e[o]),this},ComponentManager.prototype.prepare=function(t){if(!t)return this;var e=t.get(),n=t.element;t.id=n.attr("data-component-id")||t._id,t.setter&&(t.$ready||(t.setter(e,t.path),t.$ready=!0)),t.validate&&(t.$valid=t.validate(t.get(),!0)),t.done&&setTimeout(function(){t.done()},20),t.state&&t.state(0,3),t.$init&&setTimeout(function(){if($cmanager.isOperation(t.$init)){var e=OPERATION(t.$init);return e?e.call(t,t):console&&console.warn("Operation "+t.$init+" not found."),void delete t.$init}var n=$.components.get(t.$init);"function"==typeof n&&n.call(t,t),delete t.$init},2),n.trigger("component"),n.off("component");var o=n.attr(COM_ATTR_C);if(o){o=o.split(" ");for(var r=0,a=o.length;a>r;r++)n.toggleClass(o[r])}return t.id&&$.components.emit("#"+t.id,t),$.components.emit("@"+t.name,t),$.components.emit("component",t),this},ComponentManager.prototype.next=function(){var t=this.pending.shift();return void 0===t?(this.isReady&&(this.isCompiling=!1),this):void t()},ComponentManager.prototype.clear=function(){var t=this;if(0===arguments.length)return t.cache={},t;for(var e=Object.keys(t.cache),n=0,o=e.length;o>n;n++){for(var r=e[n],a=!1,i=0;i<arguments.length;i++)if(r.substring(0,arguments[i].length)===arguments[i]){a=!0;break}a&&delete t.cache[r]}return t},ComponentManager.prototype.refresh=function(){var t=this;return t.components=[],$(COM_ATTR).each(function(){var e=$(this).data(COM_ATTR);e&&e.element&&t.components.push(e)}),t},ComponentManager.prototype.isArray=function(t){var e=t.lastIndexOf("[");return-1===e?!1:(t=t.substring(e+1,t.length-1).substring(0,1),'"'===t||"'"===t?!1:!0)},ComponentManager.prototype.isOperation=function(t){return 35===t.charCodeAt(0)?!0:!1},ComponentManager.prototype.get=function(t){if(35===t.charCodeAt(0)){var e=OPERATION(t);return e?e:(console&&console.warn("Operation "+t.substring(1)+" not found."),function(){})}var n="="+t,o=this;if(o.temp[n])return o.temp[n](window);for(var r=t.split("."),a=[],i="",c=0,s=r.length-1;s>c;c++)i+=(""!==i?".":"")+r[c],a.push("if(!w."+i+")return");var p=new Function("w",a.join(";")+";return w."+t.replace(/\'/,"'"));return o.temp[n]=p,p(window)},ComponentManager.prototype.set=function(t,e){if(35===t.charCodeAt(0)){var n=OPERATION(t);return n?n(e,t):console&&console.warn("Operation "+t+" not found."),r}var o="+"+t,r=this;if(r.temp[o])return r.cache[o](window,e);for(var a=t.split("."),i=[],c="",s=0,p=a.length;p>s;s++){c+=(""!==c?".":"")+a[s];var m=r.isArray(a[s])?"[]":"{}";{if(s===p-1){if("{}"===m)break;c=c.substring(0,c.lastIndexOf("[")),i.push("if(!(w."+c+" instanceof Array))w."+c+"="+m);break}i.push("if(typeof(w."+c+')!=="object")w.'+c+"="+m)}}var u=new Function("w","a","b",i.join(";")+";var v=typeof(a) === 'function' ? a($cmanager.get(b)) : a;w."+t.replace(/\'/,"'")+"=v;return v");return r.cache[o]=u,u(window,e,t),r},ComponentManager.prototype.cleaner=function(){for(var t=this,e=Object.keys(t.events),n=!1,o=0,r=e.length;r>o;o++){var a=e[o];if(t.events[a])for(var i=Object.keys(t.events[a]),c=0,s=i.length;s>c;c++){var p=i[c],m=t.events[a][p];if(m)for(var u=0;;){var $=m[u++];if(void 0===$)break;void 0!==$.context&&(null===$.context||$.context.element&&$.context.element.closest(document.documentElement)||($.context&&$.context.element&&$.context.element.remove(),$.context.$removed=!0,$.context=null,t.events[a][p].splice(u-1,1),0===t.events[a][p].length&&(delete t.events[a][p],0===Object.keys(t.events[a]).length&&delete t.events[a]),u-=2,n=!0))}}}return n?(t.refresh(),t):t},COMPONENT("",function(){this.make=function(){var t=this.element.get(0).tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t?(this.getter=null,void(this.setter=function(t){t=this.formatter(t,!0),this.element.html(t)})):(this.element.attr(COM_ATTR_B)||this.element.attr(COM_ATTR_B,this.path),this.$parser.push.apply(this.$parser,$.components.$parser),this.$formatter.push.apply(this.$formatter,$.components.$formatter),void(this.element.$component=this))}}),setInterval(function(){$cmanager.cleaner()},6e4),setInterval(function(){$cmanager.temp={}},3e5),$.components.compile(),$(document).ready(function(){$(document).on("change keyup blur focus","input[data-component-bind],textarea[data-component-bind],select[data-component-bind]",function(t){var e=this;if("focusin"!==t.type&&"focusout"!==t.type||"checkbox"!==e.type&&"radio"!==e.type&&"SELECT"!==e.tagName){if("focusin"===t.type)return void(e.$value=e.value);if(e.$skip&&"focusout"===t.type)return void(e.$skip=!1);if(e.$component&&!e.$component.$removed&&e.$component.getter&&e.$component.setter){var n,o=e.$value;if(e.$value=null,"checkbox"===e.type||"radio"===e.type){if("keyup"===t.type)return;var n=e.checked;return e.$component.dirty(!1,!0),e.$component.getter(n,2),void(e.$component.$skip=!1)}if("SELECT"===e.tagName){if("keyup"===t.type)return;var r=e[e.selectedIndex];return n=r.value,e.$component.dirty(!1,!0),e.$component.getter(n,2),void(e.$component.$skip=!1)}if(void 0===e.$delay&&(e.$delay=parseInt(e.getAttribute("data-component-keypress-delay")||"0")),void 0===e.$only&&(e.$only="true"===e.getAttribute("data-component-keypress-only")),!e.$only||"focusout"!==t.type&&"change"!==t.type){if(void 0===e.$nokeypress){var a=e.getAttribute("data-component-keypress");a?e.$nokeypress="false"===a:e.$nokeypress=$.components.defaults.keypress===!1}var i=e.$delay;if(e.$nokeypress){if("keyup"===t.type||"focusout"===t.type)return;0===i&&(i=1)}else 0===i&&(i=$.components.defaults.delay);clearTimeout(e.$timeout),"focusout"===t.type&&(i=0),e.$timeout=setTimeout(function(){e.value!==o&&(e.$timeout=null,e.$component.dirty(!1,!0),setTimeout(function(){e.$component.getter(e.value,2,o)},2),(e.$only||"keyup"!==t.type)&&(e.$skip=!0,e.$component.$skip=!1,e.$component.setter(e.value,e.$component.path,2)))},i)}}}}),setTimeout(function(){$.components.compile()},2),setTimeout(function(){$cmanager.cleaner()},3e3)});