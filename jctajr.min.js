/* @license
jComponent + Tangular + jRouting
Copyright 2014-2015 Peter Širka All rights reserved.
Code licensed under MIT.
*/
var Thelpers={},Tangular={};Tangular.register=function(e,r){Thelpers[e]=r},Tangular.compile=function(e){e||(e="");for(var r=-1,n=[],i=-1,t=0,s=e.length,u=0;s>r++;){var a=e.substring(r,r+2);if(-1===i)if("{{"!==a);else{if(-1!==i){u++;continue}var l=e.substring(t,r);n.push(l?'unescape("'+escape(l)+'")':'""'),i=r+2}else if("}}"===a){if(u>0){u--;continue}n.push(e.substring(i,r).trim()),t=r+2,i=-1;continue}}n.push('unescape("'+escape(e.substring(t,s))+'")'),s=n.length;for(var f="$output+=",g='var $s=this;var $output="";',o=[],c=!1,p=0,d=0;s>d;d++)if(d%2!==0){var h=n[d],v=!1,r=h.lastIndexOf("|"),b="helpers.encode(@)",T=null,$=h.substring(0,3);"if "===$&&(h="if( "+h.substring(3)+"){",v=!0),"foreach "===h.substring(0,8)&&(T=h.split(" "),"var"===T[1]&&T.splice(1,1),o.push(T[1]),v=!0,c=!0,p++);var m=h.substring(0,5);if("endif"===m||"fi"===h?(h="}",v=!0):"else"===m?(h="} else {",v=!0):("end"===$||"endfor"===h.substring(0,6))&&(h=0===o.length?"}":"}})();",o.pop(),v=!0,p--,0===p&&(c=!1)),v)h=Tangular.append(h,o,c).trim();else{if(-1!==r){b=h.substring(r+1).trim(),h=h.substring(0,r),r=b.indexOf("(");var x=b;if(-1===r?b+="(@)":(x=b.substring(0,r),b=b.substring(0,r+1)+"@"+(-1===b.indexOf("()")?",":"")+b.substring(r+1)),b="helpers."+b,void 0===Thelpers[x])throw new Error('Helper: "'+x+'" not found.')}r=b.indexOf("("),b=b.substring(0,r)+".call($s,"+b.substring(r+1),h=b.replace("@",Tangular.append(h,o,c).trim())}if(v){if(T){var w=Tangular.append(T[3],o,c);h="if ("+w+"===null||"+w+"===undefined)"+w+"=[];(function(){for(var i=0,length="+w+".length;i<length;i++){var "+T[1]+"="+w+"[i];var $index=i;"}g+=h}else g+=f+h+";"}else g+=f+n[d]+";";return function(e){return new Function("helpers",g+";return $output;").call(e,Thelpers)}},Tangular.append=function(e,r){return void 0===r&&(r=[]),e.replace(/[\_\$a-zá-žÁ-ŽA-Z0-9\s]+/g,function(e,n,i){var t=i.substring(n-1,n),s=!1,u=e.trim();switch(('"'===t||"'"===t||"."===t)&&(s=!0),e.trim()){case"else":case"end":case"endfor":case"endif":case"fi":case"foreach":case"if":return e;case"$index":if(!s)return e}if(""===u)return"";if(s)return e;s=!1;for(var a=0,l=r.length;l>a;a++){var f=r[a].length;if(u.substring(0,f)===r[a]){if(u.length!==f){var t=u.substring(f,f+1);if("."!==t&&"+"!==t)continue}s=!0;break}}if(s)return u;t=u.substring(0,1);var g=t.charCodeAt(0);return g>47&&58>g?u:"$s."+u})},Tangular.render=function(e,r){return(void 0===r||null===r)&&(r={}),"string"==typeof e&&(e=Tangular.compile(e)),e(r)},Tangular.register("encode",function(e){return(void 0===e||null===e)&&(e=""),e.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(e){return(void 0===e||null===e)&&(e=""),e});
var LIMIT_HISTORY=100,LIMIT_HISTORY_ERROR=100,JRFU={},jRouting={version:103,cache:{},routes:[],history:[],errors:[],events:{},eventsOnce:{},global:{},query:{},middlewares:{},repository:{},url:"",model:null,isFirst:!0,isReady:!1,isRefresh:!1,isModernBrowser:"undefined"!=typeof history.pushState,count:0};jRouting.on=function(t,r){var n=this,e=n.events[t];return e?(e.push(r),n):(n.events[t]=[r],n)},jRouting.once=function(t,r){var n=this,e=n.eventsOnce[t];return e?(e.push(r),n):(n.eventsOnce[t]=[r],n)},jRouting.emit=function(t){var r=this,n=r.events[t]||[],e=r.eventsOnce[t]||[],i=n.length,o=e.length;if(0===i&&0===o)return r;for(var u=[],a=arguments.length,s=1;a>s;s++)u.push(arguments[s]);if(i>0)for(var s=0;i>s;s++)n[s].apply(r,u);if(o>0){for(var s=0;i>s;s++)e[s].apply(r,u);delete r.eventsOnce[t]}},jRouting.route=function(t,r,n,e){var i;if(r instanceof Array){var i=n;n=r,r=i}"function"==typeof n&&(i=e,e=n,n=i);var o=this,u=t.count("/")+(-1===t.indexOf("*")?0:10),a=o._route(t.trim()),s=[];if("string"==typeof n&&(n=n.split(",")),-1!==t.indexOf("{")){u-=100;for(var f=0;f<a.length;f++)"{"===a[f].substring(0,1)&&s.push(f);u-=s.length}return o.routes.push({url:a,fn:r,priority:u,params:s,middleware:n||null,init:e,count:0,pending:!1}),o.routes.sort(function(t,r){return t.priority>r.priority?-1:t.priority<r.priority?1:0}),o},jRouting.middleware=function(t,r){var n=this;return n.middlewares[t]=r,n},jRouting.refresh=function(){var t=this;return t.location(t.url,!0)},jRouting.reload=function(){return jRouting.refresh()},jRouting._route=function(t){t=t.toLowerCase(),"/"===t.charIndex(0)&&(t=t.substring(1)),"/"===t.charIndex(t.length-1)&&(t=t.substring(0,t.length-1));var r=t.split("/");return 1===r.length&&""===r[0]&&(r[0]="/"),r},jRouting._route_param=function(t,r){var n=[];if(!r||!t)return n;var e=r.params.length;if(0===e)return n;for(var i=0;e>i;i++){var o=t[r.params[i]];n.push("/"===o?"":o)}return n},jRouting._route_compare=function(t,r){var n=t.length,e=1===n&&"/"===t[0];if(r.length!==n)return!1;for(var i=0;n>i;i++){var o=r[i];if("undefined"==typeof o)return!1;if(e||"{"!==o.charIndex(0)){if("*"===o)return!0;if(t[i]!==o)return!1}}return!0},jRouting.location=function(t,r){var n=t.indexOf("?");-1!==n&&(t=t.substring(0,n)),t=JRFU.prepareUrl(t),t=JRFU.path(t);var e=this,i=e._route(t),o=[],u=!0;e.isRefresh=r||!1,e.count++,r||e.url.length>0&&e.history[e.history.length-1]!==e.url&&(e.history.push(e.url),e.history.length>LIMIT_HISTORY&&e.history.shift());for(var a=e.routes.length,s=0;a>s;s++){var f=e.routes[s];if(e._route_compare(i,f.url)&&(-1===f.url.indexOf("*")&&(u=!1),!(f.once&&f.count>0))){f.count++,o.push(f);break}}var p=!1,c=[];e.url.length>0&&(e.cache[e.url]=e.repository),e.url=t,e.repository=e.cache[t],void 0===e.repository&&(e.repository={}),e._params(),e.emit("location",t),a=o.length;for(var s=0;a>s;s++){var f=o[s];if(!f.pending)if(f.middleware&&0!==f.middleware.length)!function(t){for(var r=t.middleware.length,n=[],o=0;r>o;o++)!function(t,r){n.push(function(n){r.call(e,n,t)})}(t,jRouting.middlewares[t.middleware[o]]);return t.init?(t.pending=!0,t.init(function(){n.async(function(){t.fn.apply(e,e._route_param(i,t)),t.pending=!1})}),void(t.init=null)):(t.pending=!0,void n.async(function(){t.fn.apply(e,e._route_param(i,t)),t.pending=!1}))}(f);else{if(!f.init){f.fn.apply(e,e._route_param(i,f));continue}f.pending=!0,function(t){t.init(function(){t.fn.apply(e,e._route_param(i,t)),t.pending=!1})}(f),f.init=null}}p&&e.status(500,c),u&&e.status(404,new Error("Route not found."))},jRouting.prev=function(){var t=this;return t.history[t.history.length-1]},jRouting.back=function(){var t=this,r=t.history.pop()||"/";return t.url="",t.redirect(r,!0),t},jRouting.status=function(t,r){var n=this;return n.emit("status",t||404,r),n},jRouting.redirect=function(t,r){var n=this;return n.isModernBrowser?(history.pushState(null,null,t),n.model=r||null,n.location(t,!1),n):(window.location.href=t,!1)},jRouting.cookie={read:function(t){for(var r=document.cookie.split(";"),n=0;n<r.length;n++){var e=r[n];" "===e.charAt(0)&&(e=e.substring(1));var i=e.split("=");if(i.length>1&&i[0]===t)return i[1]}return""},write:function(t,r,n){var e="";if("number"==typeof n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),e="; expires="+i.toGMTString()}else n instanceof Date&&(e="; expires="+n.toGMTString());document.cookie=t+"="+r+e+"; path=/"},remove:function(t){this.write(t,"",-1)}},jRouting._params=function(){for(var t=this,r={},n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<n.length;e++){var i=n[e].split("=");if(2===i.length){var o=decodeURIComponent(i[0]),u=decodeURIComponent(i[1]),a=r[o]instanceof Array;"undefined"==typeof r[o]||a||(r[o]=[r[o]]),a?r[o].push(u):r[o]=u}}return t.query=r,t},JRFU.path=function(t,r){"undefined"==typeof r&&(r="/");var n=t.indexOf("?"),e="";-1!==n&&(e=t.substring(n),t=t.substring(0,n));var i=t.charIndex(t.length-1);return i!==r&&(t+=r),t+e},Array.prototype.forEach||(Array.prototype.forEach=function(t){for(var r=this,n=0;n<r.length;n++)t(r[n],n);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var r=this,n=0;n<r.length;n++)if(t===r[n])return n;return-1}),$(window).bind("popstate",function(){var t=window.location.hash||"";0===t.length&&(t=window.location.pathname),jRouting.location(JRFU.path(t))}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s]+|[\s]+$/g,"")}),String.prototype.count||(String.prototype.count=function(t){var r=0,n=0;do r=this.indexOf(t,r+t.length),r>0&&n++;while(r>0);return n}),String.prototype.charIndex||(String.prototype.charIndex=function(t){return this.toString().substring(t,t+1)}),JRFU.path=function(t,r){"undefined"==typeof r&&(r="/");var n=t.indexOf("?"),e="";-1!==n&&(e=t.substring(n),t=t.substring(0,n));var i=t.charIndex(t.length-1);return i!==r&&(t+=r),t+e},JRFU.prepareUrl=function(t){return index=t.indexOf("#"),-1!==index?t.substring(0,index):t},Array.prototype.async||(Array.prototype.async=function(t){var r=this,n=r.shift();return void 0===n?(t&&t(),r):(n(function(){setTimeout(function(){r.async(t)},1)}),r)}),jRouting.on("error",function(t,r,n){var e=this;e.errors.push({error:t,url:r,name:n,date:new Date}),e.errors.length>LIMIT_HISTORY_ERROR&&e.errors.shift()}),$.fn.jRouting=function(t){if(!jRouting.isModernBrowser)return this;var r=function(t){t.preventDefault(),jRouting.redirect($(this).attr("href"))};return t?($(document).on("click",this.selector,r),this):(this.filter("a").bind("click",r),this)},$(document).ready(function(){var t=window.location.pathname;if(jRouting.isReady=!0,"undefined"==typeof jRouting.events.ready)jRouting.location(JRFU.path(JRFU.prepareUrl(t)));else{var r=JRFU.path(JRFU.prepareUrl(t));jRouting.emit("ready",r),jRouting.emit("load",r)}});
Date.prototype.format||(Date.prototype.format=function(t){var e=this,r=!1;if(t&&33===t.charCodeAt(0)&&(r=!0,t=t.substring(1)),void 0===t||null===t||""===t)return e.getFullYear()+"-"+(e.getMonth()+1).toString().padLeft(2,"0")+"-"+e.getDate().toString().padLeft(2,"0")+"T"+e.getHours().toString().padLeft(2,"0")+":"+e.getMinutes().toString().padLeft(2,"0")+":"+e.getSeconds().toString().padLeft(2,"0")+":"+e.getMilliseconds().toString();var n=e.getHours();return r&&n>=12&&(n-=12),t.replace(/yyyy|yy|MM|M|dd|d|HH|H|hh|h|mm|m|ss|s|a/g,function(t){switch(t){case"yyyy":return e.getFullYear();case"yy":return e.getYear();case"MM":return(e.getMonth()+1).toString().padLeft(2,"0");case"M":return e.getMonth()+1;case"dd":return e.getDate().toString().padLeft(2,"0");case"d":return e.getDate();case"HH":case"hh":return n.toString().padLeft(2,"0");case"H":case"h":return e.getHours();case"mm":return e.getMinutes().toString().padLeft(2,"0");case"m":return e.getMinutes();case"ss":return e.getSeconds().toString().padLeft(2,"0");case"s":return e.getSeconds();case"a":var r="AM";return e.getHours()>=12&&(r="PM"),r}})}),Number.prototype.format||(Number.prototype.format=function(t,e,r){var n=this,a=n.toString(),o="",g="",i=45===a.charCodeAt(0)?"-":"";i&&(a=a.substring(1));var s=a.indexOf(".");if(typeof t==='string'){var u=e;e=t,t=u}void 0===e&&(e=" "),-1!==s&&(o=a.substring(s+1),a=a.substring(0,s)),s=-1;for(var p=a.length-1;p>=0;p--)s++,s>0&&s%3===0&&(g=e+g),g=a.substring(p,p+1)+g;return(t||o.length)&&(o=o.length>t?o.substring(0,t):o.padRight(t,"0")),o.length&&void 0===r&&(r="."===e?",":"."),i+g+(o.length?r+o:"")}),String.prototype.padLeft||(String.prototype.padLeft=function(t,e){var r=this.toString();return Array(Math.max(0,t-r.length+1)).join(e||"0")+r}),String.prototype.padRight||(String.prototype.padRight=function(t,e){var r=this.toString();return r+Array(Math.max(0,t-r.length+1)).join(e||"0")}),Tangular.register("format",function(t,e){return void 0===t||null===t?"":("string"==typeof t&&(t=-1!==t.indexOf("T")?new Date(t):parseFloat(t)),t.format(e))});
function $components_url(e){var t=e.indexOf("?"),n=[];return $.components.$version&&n.push("version="+encodeURIComponent($.components.$version)),$.components.$language&&n.push("language="+encodeURIComponent($.components.$language)),0===n.length?e:(e+=-1!==t?"&":"?",e+n.join("&"))}function $components_ready(){clearTimeout($cmanager.timeout),$cmanager.timeout=setTimeout(function(){$cmanager.initialize();var e=$cmanager.components.length;if($(document).trigger("components",[e]),$cmanager.isReady||($cmanager.clear("valid","dirty"),$cmanager.isReady=!0,$.components.emit("init"),$.components.emit("ready")),$cmanager.isCompiling=!1,$cmanager.ready){for(var t=$cmanager.ready,n=0,o=t.length;o>n;n++)t[n](e);delete $cmanager.ready}},100)}function component_init(e,t){var n,o=e.get(0).tagName;$.components.debug&&console.log("%c$.components.init: "+t.name+" ("+(t.id||t._id)+")","color:green"),"INPUT"===o||"SELECT"===o||"TEXTAREA"===o?(t.$input=!0,n=t.element):n=e.find(COM_DATA_BIND_SELECTOR),n.each(function(){this.$component||(this.$component=t)}),$cmanager.components.push(t),$cmanager.init.push(t),$.components.compile(e),$components_ready()}function Component(e){this._id="component"+Math.floor(1e5*Math.random()),this.$dirty=!0,this.$valid=!0,this.$validate=!1,this.$parser=new Array(0),this.$formatter=new Array(0),this.$skip=!1,this.$ready=!1,this.$path,this.name=e,this.path,this.type,this.id,this.make,this.done,this.prerender,this.destroy,this.state,this.validate,this.getter=function(e,t,n){return e=this.parser(e),2===t&&(this.$skip=!0),e!==this.get()||2===t&&null===n?(this.set(this.path,e,t),this):this},this.setter=function(e,t,n){var o=this;if(2===n&&o.$skip===!0)return o.$skip=!1,o;var r=o.$input===!0?this.element:this.element.find(COM_DATA_BIND_SELECTOR);e=o.formatter(e),r.each(function(){var t=this.$component.path;if(!(t&&t.length>0&&t!==o.path)){if("checkbox"===this.type){var n=null!==e&&void 0!==e?e.toString().toLowerCase():"";return void(this.checked="true"===n||"1"===n||"on"===n)}return(void 0===e||null===e)&&(e=""),"select-one"===this.type||"select"===this.type?void $(this).val(e):void(this.value=e)}})},this.$parser.push(function(e,t,n){if("number"===n||"currency"===n||"float"===n){"string"==typeof t&&(t=t.replace(/\s/g,"").replace(/,/g,"."));var o=parseFloat(t);return isNaN(o)&&(o=null),o}return t})}function component(e,t){return COMPONENT(e,t)}function COMPONENT(e,t){var n=function(n){var o=new Component(e);return o.element=n,o.setPath(n.attr(COM_ATTR_P)||o._id),t.call(o),o};$cmanager.register[e]=n}function component_async(e,t,n){var o=e.shift();return void 0===o?void(n&&n()):void t(o,function(){component_async(e,t,n)})}function ComponentManager(){this.isReady=!1,this.isCompiling=!1,this.init=[],this.register={},this.cache={},this.storage={},this.cacheblocked={},this.temp={},this.model={},this.components=[],this.schemas={},this.toggle=[],this.ready=[],this.events={},this.timeout,this.pending=[],this.timeoutStyles,this.styles=[],this.operations={}}function $components_keypress(e,t,n){e.value!==t&&(clearTimeout(e.$timeout),e.$timeout=null,e.$component.dirty(!1,!0),e.value!==e.$value2&&setTimeout(function(){e.$value2=e.value,e.$component.getter(e.value,2,t)},5),(e.$only||"keydown"!==n.type||13===n.keyCode)&&(e.$skip=!0,e.$component.$skip=!1,e.$component.setter(e.value,e.$component.path,2),e.$value=e.value,clearTimeout(e.$cleanupmemory),e.$cleanupmemory=setTimeout(function(){delete e.$value2,delete e.$value},300)))}function $components_save(){$.components.defaults.localstorage&&localStorage.setItem($.components.$localstorage+".cache",JSON.stringify($cmanager.storage))}function SET(e,t,n,o){return"boolean"==typeof n?$.components.set(e,t,n):n?void setTimeout(function(){$.components.set(e,t,o)},n):$.components.set(e,t,o)}function INC(e,t,n,o){return"boolean"==typeof n?$.components.inc(e,t,n):n?void setTimeout(function(){$.components.inc(e,t,o)},n):$.components.inc(e,t,o)}function EXTEND(e,t,n,o){return"boolean"==typeof n?$.components.extend(e,t,n):n?void setTimeout(function(){$.components.extend(e,t,o)},n):$.components.extend(e,t,o)}function PUSH(e,t,n,o){return"boolean"==typeof n?$.components.push(e,t,n):n?void setTimeout(function(){$.components.push(e,t,o)},n):$.components.push(e,t,o)}function RESET(e,t){return $.components.reset(e,t)}function WATCH(e,t,n){return $.components.on("watch",e,t,n)}function GET(e){return $.components.get(e)}function CACHE(e,t,n){return $.components.cache(e,t,n)}function NOTIFY(){return $.components.notify.apply($.components,arguments)}function NOTMODIFIED(e,t,n){void 0===t&&(t=$.components.GET(e)),void 0===t&&(t=null),n&&(e=e.concat("#",n));var o=$components_hash(JSON.stringify(t,n));return $cmanager.cache[e]===o?!0:($cmanager.cache[e]=o,!1)}function FIND(e){return 35===e.charCodeAt(0)?$.components.findById(e.substring(1)):$.components.findByName(e)}function UPDATE(e,t,n){return"boolean"==typeof t?$.components.update(e,t):t?void setTimeout(function(){$.components.update(e,n)},t):$.components.update(e,n)}function CHANGE(e,t){return $.components.change(e,t)}function INJECT(e,t,n,o){return $.components.inject(e,t,n,o)}function SCHEMA(e,t,n){return $.components.schema(e,t,n)}function OPERATION(e,t){return t?($cmanager.operations[e]=t,t):35===e.charCodeAt(0)?$cmanager.operations[e.substring(1)]:$cmanager.operations[e]}function ON(e,t,n,o){$.components.on(e,t,n,o)}function EVALUATE(e,t){return $.components.evaluate(e,t)}function STYLE(e){clearTimeout($cmanager.timeoutStyles),$cmanager.styles.push(e),$cmanager.timeoutStyles=setTimeout(function(){$('<style type="text/css">'+$cmanager.styles.join("")+"</style>").appendTo("head"),$cmanager.styles=[]},50)}function BLOCKED(e,t,n){return $.components.blocked(e,t,n)}function $components_hash(e){if(!e)return 0;var t,n,o=0;if(0===e.length)return o;var r=e.length;for(t=0;r>t;t++)n=e.charCodeAt(t),o=(o<<5)-o+n,o|=0;return o}function CONTROLLER(){var e=arguments[arguments.length-1],t={};t.name=arguments[0];var n=function(e){var n=arguments;return e.replace(/\{\d+\}/g,function(e){return n[parseInt(e.substring(1,e.length-1))+1]}).replace(/\{\w+\}/g,function(e){return t[e.substring(1,e.length-1)]})};e.call(t,n,t)}var $cmanager=new ComponentManager,COM_DATA_BIND_SELECTOR="input[data-component-bind],textarea[data-component-bind],select[data-component-bind]",COM_ATTR="[data-component]",COM_ATTR_U="data-component-url",COM_ATTR_URL="["+COM_ATTR_U+"]",COM_ATTR_B="data-component-bind",COM_ATTR_P="data-component-path",COM_ATTR_T="data-component-template",COM_ATTR_I="data-component-init",COM_ATTR_R="data-component-removed",COM_ATTR_C="data-component-class";$.fn.component=function(){return this.data(COM_ATTR)},$.components=function(e){return $cmanager.isCompiling?$.components:$.components.compile(e)},$.components.evaluate=function(e,t){var n="eval"+t,o=$cmanager.cache[n],r=$.components.get(e);return $.components.debug&&console.log("%c$.components.evaluate("+e+")","color:gray"),void 0!==o?o.call(r,r,e):(-1===t.indexOf("return")&&(t="return "+t),o=new Function("value","path",t),$cmanager.cache[n]=o,o.call(r,r,e))},$.components.defaults={},$.components.defaults.delay=300,$.components.defaults.keypress=!0,$.components.defaults.localstorage=!0,$.components.debug=!1,$.components.version="v2.1.3",$.components.$localstorage="jcomponent",$.components.$version="",$.components.$language="",$.components.$formatter=[],$.components.$parser=[],$.components.compile=function(e){if($cmanager.isCompiling=!0,$.components.$inject(),$cmanager.pending.length>0)return $cmanager.pending.push(function(){$.components.compile(e)}),$.components;var t=e?e.find(COM_ATTR):$(COM_ATTR),n=!1;return t.each(function(){if(!n){var e=$(this),t=e.attr("data-component");if(!e.data(COM_ATTR)&&!e.attr(COM_ATTR_R)){var o=$cmanager.register[t||""];if(o){var r=o(e);r.$init=e.attr(COM_ATTR_I)||null,r.type=e.attr("data-component-type")||"",r.id=e.attr("data-component-id")||r._id,e.data(COM_ATTR,r);var a=e.attr(COM_ATTR_T)||r.template;if(a&&(r.template=a),e.attr(COM_ATTR_U))throw new Error("You cannot use [data-component-url] for the component: "+r.name+"["+r.path+"]. Instead of it you must use data-component-template.");if("string"==typeof a){var c=function(t){r.prerender&&(t=prerender(t)),"function"==typeof r.make&&r.make(t),component_init(e,r)},i=a.substring(0,1);return void("."===i||"#"===i||"["===i?c($(i).html()):$.get($components_url(a),c))}if("string"==typeof r.make)return-1!==r.make.indexOf("<")?(r.prerender&&(r.make=r.prerender(r.make)),e.html(r.make),void component_init(e,r)):void $.get($components_url(r.make),function(t){r.prerender&&(t=prerender(t)),e.html(t),component_init(e,r)});r.make&&r.make()&&(n=!0),component_init(e,r)}}}}),n?void $.components.compile():void 0!==e?void $cmanager.next():0===$cmanager.toggle.length?void $cmanager.next():void component_async($cmanager.toggle,function(e,t){for(var n=0,o=e.toggle.length;o>n;n++)e.element.toggleClass(e.toggle[n]);t()},function(){$cmanager.next()})},$.components.$inject=function(){var e=$(COM_ATTR_URL),t=[],n=0;e.each(function(){var e=$(this);e.data(COM_ATTR_URL)||(e.data(COM_ATTR_URL,"1"),t.push({element:e,cb:e.attr(COM_ATTR_I),path:e.attr(COM_ATTR_P),url:e.attr(COM_ATTR_U),toggle:(e.attr(COM_ATTR_C)||"").split(" ")}))}),0!==t.length&&component_async(t,function(e,t){e.element.load($components_url(e.url),function(){if(e.path){var o=e.element.find(COM_ATTR);o.each(function(){var t=$(this);$.each(this.attributes,function(){this.specified&&t.attr(this.name,this.value.replace("$",e.path))})})}if(e.toggle.length>0&&""!==e.toggle[0]&&$cmanager.toggle.push(e),e.cb&&!e.element.attr("data-component")){var r=$cmanager.get(e.cb);"function"==typeof r&&r(e.element)}n++,t()})},function(){$cmanager.clear("valid","dirty"),0!==n&&$.components.compile()})},$.components.inject=function(e,t,n){"function"==typeof t&&(timeout=n,n=t,t="body"),t||(t="body");var o=e.lastIndexOf(".");if(o=-1!==o?e.substring(o).toLowerCase():"",".js"===o){var r=d.createElement("script");return r.type="text/javascript",r.async=!0,r.onload=function(){n&&n()},r.src=Url,void document.getElementsByTagName("head")[0].appendChild(r)}if(".css"===o){var a=document.createElement("link");return a.type="text/css",a.rel="stylesheet",a.href="style.css",void document.getElementsByTagName("head")[0].appendChild(a)}if("body"===t){var c=Math.floor(1e5*Math.random()),i='data-component-injector="'+c+'"';$(t).append("<div "+i+"></div>"),t=$(t).find("> div["+i+"]")}return $(t).load($components_url(e),function(){$.components.compile(),n&&n()}),$.components},$.components.parseQuery=function(e){if(e||(e=window.location.search),!e)return{};"?"===e.substring(0,1)&&(e=e.substring(1));for(var t=e.split("&"),n={},o=0,r=t.length;r>o;o++){var a=t[o].split("="),c=a[0],i=decodeURIComponent((a[1]||"").replace(/\+/g,"%20"));n[c]?(n[c]instanceof Array||(n[c]=[n[c]]),n[c].push(i)):n[c]=i}return n},$.components.POST=function(e,t,n,o,r){if(e||(e=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.POST("+e+")","color:magenta"),$.ajax($components_url(e),{type:"POST",data:JSON.stringify(t),success:function(e){return"string"==typeof n?$cmanager.remap(n,e):void(n&&n(e))},error:function(t,n,o){return $.components.emit("error",o,t.status,e),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,t.status,n))},contentType:"application/json"})},o||0),$.components},$.components.PUT=function(e,t,n,o,r){if(e||(e=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.PUT("+e+")","color:magenta"),$.ajax($components_url(e),{type:"PUT",data:JSON.stringify(t),success:function(e){return"string"==typeof n?$cmanager.remap(n,e):void(n&&n(e))},error:function(t,n,o){return $.components.emit("error",o,t.status,e),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,t.status,n))},contentType:"application/json"})},o||0),$.components},$.components.TEMPLATE=function(e,t,n){return $cmanager.cache[e]?("string"==typeof t?SET(t,$cmanager.cache[e]):t($cmanager.cache[e]),$.components):($.components.GET(e,{},function(o){var r=$cmanager.cache[e]=n?n(o):o;"string"==typeof t?SET(t,r):t(r)}),$.components)},$.components.GET=function(e,t,n,o,r){if(e||(e=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.GET("+e+")","color:magenta"),t&&(e+="?"+jQuery.param(t)),$.ajax($components_url(e),{type:"GET",success:function(e){return"string"==typeof n?$cmanager.remap(n,e):void(n&&n(e))},error:function(t,n,o){return $.components.emit("error",o,t.status,e),"string"==typeof r?$cmanager.remap(r,o):void(r&&r(o,t.status,n))}})},o||0),$.components},$.components.DELETE=function(e,t,n,o,r){if(e||(e=window.location.pathname),"number"==typeof n&&(o=n,n=void 0),"number"!=typeof o){var a=r;r=o,o=a}return setTimeout(function(){$.components.debug&&console.log("%c$.components.DELETE("+e+")","color:magenta"),$.ajax($components_url(e),{type:"DELETE",data:JSON.stringify(t),success:function(e){return"string"==typeof n?$cmanager.remap(n,e):void(n&&n(e))},error:function(t,n,o){if($.components.emit("error",o,t.status,e),"string"==typeof r)return $cmanager.remap(r,o);if(!r)throw new Error(o);r(o,t.status,n)},contentType:"application/json"})},o||0),$.components},$.components.GETCACHE=function(e,t,n,o,r,a){if("boolean"==typeof r){var c=a;a=r,r=c}var i=a?void 0:$cmanager.cacherest("GET",e,t);return void 0!==i?("string"==typeof n?$cmanager.remap(n,i):n(i),$.components):($.components.GET(e,t,function(r){$cmanager.cacherest("GET",e,t,r,o),"string"==typeof n?$cmanager.remap(n,r):n(r)},r),$.components)},$.components.POSTCACHE=function(e,t,n,o,r,a){if("boolean"==typeof r){var c=a;a=r,r=c}var i=a?void 0:$cmanager.cacherest("POST",e,t);return void 0!==i?("string"==typeof n?$cmanager.remap(n,i):n(i),$.components):($.components.POST(e,t,function(r){$cmanager.cacherest("POST",e,t,r,o),"string"==typeof n?$cmanager.remap(n,r):n(r)},r),$.components)},$.components.cache=function(e,t,n){return $cmanager.cachestorage(e,t,n)},$.components.removeCache=function(e,t){if(t)for(var n in $cmanager.storage)-1!==n.indexOf(e)&&delete $cmanager.storage[e];else delete $cmanager.storage[e];return $components_save(),$.components},$.components.REMOVECACHE=function(e,t,n){n=JSON.stringify(n);var o=$components_hash(e+"#"+t.replace(/\//g,"")+n).toString();return delete $cmanager.storage[o],$components_save(),$.components},$.components.ready=function(e){return $cmanager.ready&&$cmanager.ready.push(e),$.components},$.components.watch=function(e,t,n){return $.components.on("watch",e,t),n?(setTimeout(function(){t.call($.components,e,$cmanager.get(e))},5),$.components):$.components},$.components.on=function(e,t,n,o){"function"==typeof t?(n=t,t=""):t=t.replace(".*",""),$.components.debug&&console.log("%c$.components.on("+e+(t?", "+t:"")+")","color:blue");var r=null;return 33===t.charCodeAt(0)&&(t=t.substring(1),r=t),$cmanager.events[t]?$cmanager.events[t][e]||($cmanager.events[t][e]=[]):($cmanager.events[t]={},$cmanager.events[t][e]=[]),$cmanager.events[t][e].push({fn:n,id:this._id,path:r}),o?(n.call($.components,t,$cmanager.get(t)),$.components):$.components},$.components.$emit2=function(e,t,n){var o=$cmanager.events[t];if(!o)return!1;if(o=o[e],!o)return!1;for(var r=0,a=o.length;a>r;r++){var c=o[r];c.path&&c.path!==t||c.fn.apply(c.context,n)}return!0},$.components.$emitonly=function(e,t,n,o){for(var r={},a=Object.keys(t),c=0,i=a.length;i>c;c++)for(var s=a[c].split("."),p="",m=0,u=s.length;u>m;m++)p+=(p?".":"")+s[m],r[p]=t[p];return $.components.$emit2(e,"*",[o,r[o]]),Object.keys(r).forEach(function(t){$.components.$emit2(e,t,[o,r[t]])}),this},$.components.$emit=function(e,t){if(t){for(var n=t.split("."),o=[],r="watch"===e?1:2,a=arguments.length;a>r;r++)o.push(arguments[r]);$.components.$emit2(e,"*",o);for(var c="",r=0,a=n.length;a>r;r++){var i=n[r],s=n[r];if("*"!==i){if("]"===s.substring(s.length-1,s.length)){var p=s.lastIndexOf("[");s=s.substring(0,p)}c+=r>0?".":"",o[1]=$.components.get(c+i),$.components.$emit2(e,c+i,o),i!==s&&$.components.$emit2(e,c+s,o),c+=i}}return!0}},$.components.emit=function(e){var t=$cmanager.events[""];if(!t)return!1;if(t=$cmanager.events[""][e],!t)return!1;for(var n=[],o=1,r=arguments.length;r>o;o++)n.push(arguments[o]);for(var o=0,r=t.length;r>o;o++)t[o].fn.apply(t[o].context,n);return!0},$.components.change=function(e,t){return void 0===t?!$.components.dirty(e):!$.components.dirty(e,!t)},$.components.valid=function(e,t,n){var o,r=t instanceof Array,a="valid"+e+(r?">"+t.join("|"):"");if(r&&(o=t,t=void 0),"boolean"!=typeof t&&void 0!==$cmanager.cache[a])return $cmanager.cache[a];$.components.debug&&console.log("%c$.components.valid("+e+")","color:orange");var c=!0,i=void 0!==t?[]:null,s=n?$.components.eachPath:$.components.each;return s(function(a){if(!r||-1===o.indexOf(a.path)){if(void 0===t)return void(a.$valid===!1&&(c=!1));var s=!0,p=!0;if(n){var m=-1!==a.path.substring(a.path.length-1);m||(s=a.path===e),p=a.path===e}else p=!0,s=!0;s&&a.state&&i.push(a),p&&(a.$valid=t,a.$validate=!1),a.$valid===!1&&(c=!1)}},e),$cmanager.clear("valid"),$cmanager.cache[a]=c,$.components.state(i,1,1),c},$.components.dirty=function(e,t,n){var o,r=t instanceof Array,a="dirty"+e+(r?">"+t.join("|"):"");if(r&&(o=t,t=void 0),"boolean"!=typeof t&&void 0!==$cmanager.cache[a])return $cmanager.cache[a];$.components.debug&&console.log("%c$.components.dirty("+e+")","color:orange");var c=!0,i=void 0!==t?[]:null,s=n?$.components.eachPath:$.components.each;return s(function(a){if(!r||-1===o.indexOf(a.path)){if(void 0===t)return void(a.$dirty===!1&&(c=!1));var s=!0,p=!0;if(n){var m=-1!==a.path.substring(a.path.length-1);m||(s=a.path===e),p=a.path===e}else p=!0,s=!0;s&&a.state&&i.push(a),p&&(a.$dirty=t),a.$dirty===!1&&(c=!1)}},e),$cmanager.clear("dirty"),$cmanager.cache[a]=c,$.components.state(i,2,2),c},$.components.update=function(e,t){var n=33===e.charCodeAt(0);if(n&&(e=e.substring(1)),e=e.replace(".*",""),!e)return $.components;var o,r=[],a=!1,c={};$.components.debug&&console.log("%c$.components.update("+(n?"!":"")+e+")","color:red");var i=e.split("."),s=i.length;$.components.each(function(n){if(n.path){for(var o=0;s>o;o++)if(n.$$path[o]&&n.$$path[o]!==i[o])return;if(!n.$path||n.$path===e){var p=n.get();n.setter&&n.setter(p,e,1),n.$ready=!0,t===!0?(n.$dirty=!0,n.$valid=!0,n.$validate=!1,n.validate&&(n.$valid=n.validate(p))):n.validate&&n.valid(n.validate(p),!0),n.state&&r.push(n),n.path===e&&(a=!0),c[n.path]=p}}},n?e:void 0,void 0,n),t&&($cmanager.clear("dirty"),$cmanager.clear("valid")),c[e]||(c[e]=$.components.get(e));for(var p=0,o=r.length;o>p;p++)r[p].state(1,4);return o=e.length,Object.keys($cmanager.events).forEach(function(t){t.substring(0,o)===e&&(c[t]=$.components.get(t))}),$.components.$emitonly("watch",c,1,e),$.components},$.components.notify=function(){var e=arguments,t=arguments.length;return $.components.each(function(n){if(n.path){for(var o=!1,r=0;t>r;r++)if(n.path===e[r]){o=!0;break}o&&n.setter(n.get(),n.path)}}),Object.keys($cmanager.events).forEach(function(n){for(var o=!1,r=0;t>r;r++)if(n===e[r]){o=!0;break}o&&$.components.$emit2("watch",n,[n,$.components.get(n)])}),$.components},$.components.extend=function(e,t,n){var o=$.components.get(e);return(null===o||void 0===o)&&(o={}),$.components.debug&&console.log("%c$.components.extend("+e+")","color:silver"),$.components.set(e,$.extend(o,t),n),$.components},$.components.set=function(e,t,n){var o=33===e.charCodeAt(0);if(o&&(e=e.substring(1)),43===e.charCodeAt(0))return e=e.substring(1),$.components.push(e,t,n);if(!e)return $.components;var r="object"==typeof t&&!(t instanceof Array)&&null!==t&&void 0!==t,a=n===!0;if(a&&(n=1),$.components.debug&&!r&&console.log("%c$.components.set("+e+")","color:red"),$cmanager.set(e,t),r)return $.components.update(e,a);var c=$cmanager.get(e),i=[];void 0===n&&(n=1);var s=e.split("."),p=s.length;$.components.each(function(t){if(t.path){for(var o=0;p>o;o++)if(t.$$path[o]&&t.$$path[o]!==s[o])return;t.$path&&t.$path!==e||(t.path===e?t.setter&&t.setter(c,e,n):t.setter&&t.setter($.components.get(t.path),e,n),t.$ready=!0,t.state&&i.push(t),a?(t.$dirty=!0,t.$valid=!0,t.$validate=!1,t.validate&&(t.$valid=t.validate(c))):t.validate&&t.valid(t.validate(c),!0))}},e,!0,o),a&&($cmanager.clear("dirty"),$cmanager.clear("valid"));for(var m=0,u=i.length;u>m;m++)i[m].state(n,5);return $.components.$emit("watch",e,void 0,n,o),$.components},$.components.push=function(e,t,n){$.components.debug&&console.log("%c$.components.push("+e+")","color:silver");var o=$.components.get(e),r=!1;o instanceof Array||(o=[],r=!0);var a=!0;return t instanceof Array?t.length>0?o.push.apply(o,t):a=!1:o.push(t),r?$.components.set(e,o,n):a&&$.components.update(e,n),self},$.components.clean=function(){return $cmanager.cleaner(),$.components},$.components.get=function(e){return $.components.debug&&console.log("%c$.components.get("+e+")","color:gray"),$cmanager.get(e)},$.components.remove=function(e){if(e instanceof jQuery){e.find(COM_ATTR).attr(COM_ATTR_R,"true").each(function(){var e=$(this).data("component");e&&(e.$removed=!0)}),e.attr(COM_ATTR_T)&&e.attr(COM_ATTR_R,"true");var t=e.data("component");return t&&(t.$removed=!0),$cmanager.cleaner(),$.components}return $cmanager.clear(),$.components.each(function(e){e.remove(!0)},e),$cmanager.cleaner(),$.components},$.components.validate=function(e,t){var n=[],o=!0;return $.components.each(function(e){t&&-1!==t.indexOf(e.path)||(e.state&&n.push(e),e.$validate=!0,e.validate&&(e.$valid=e.validate($cmanager.get(e.path)),e.$valid||(o=!1)))},e),$cmanager.clear("valid"),$.components.state(n,1,1),$.components.$emit("validate",e),o},$.components.errors=function(e,t){e instanceof Array&&(t=e,e=void 0);var n=[];return $.components.each(function(e){t&&-1!==t.indexOf(e.path)||e.$valid===!1&&n.push(e)},e),n},$.components.can=function(e,t){return!$.components.dirty(e,t)&&$.components.valid(e,t)},$.components.disable=function(e,t){return $.components.dirty(e,t)||!$.components.valid(e,t)},$.components.invalid=function(e){var t=$.components;return t.dirty(e,!1),t.valid(e,!1,!0),t},$.components.blocked=function(e,t,n){var o=e,r=$cmanager.cacheblocked[o],a=Date.now();if($.components.debug&&console.log("%c$.components.blocked("+e+")","color:silver"),r>a)return!0;var c=$.components.defaults.localstorage&&t>1e4;return $cmanager.cacheblocked[o]=a+t,c&&localStorage.setItem($.components.$localstorage+".blocked",JSON.stringify($cmanager.cacheblocked)),n&&n(),!1},$.components.state=function(e,t,n){e&&0!==e.length&&setTimeout(function(){for(var o=0,r=e.length;r>o;o++)e[o].state(t,n)},2)},$.components.reset=function(e,t){if(t>0)return setTimeout(function(){$.components.reset(e)},t),$.components;$.components.debug&&console.log("%c$.components.reset("+e+")","color:orange");var n=[];return $.components.each(function(e){e.state&&n.push(e),e.$dirty=!0,e.$valid=!0,e.$validate=!1,e.validate&&(e.$valid=e.validate(e.get()))},e),$cmanager.clear("valid","dirty"),$.components.state(n,1,3),$.components.$emit("reset",e),$.components},$.components.findByName=function(e,t,n){"function"==typeof t&&(n=t,t=void 0);var o,r="function"==typeof n;return $.components.each(function(t){return t.name===e?r?void n(t):(o=t,!0):void 0},t),r?$.components:o},$.components.findByPath=function(e,t){"function"==typeof e&&(t=e,e=void 0);var n,o="function"==typeof t;return $.components.each(function(e){return o?void t(e):(n=e,!0)},e),o?$.components:n},$.components.findById=function(e,t,n){"function"==typeof t&&(n=t,t=void 0);var o,r="function"==typeof n;return $.components.each(function(t){return t.id===e?r?void n(t):(o=t,!0):void 0},t),r?$.components:o},$.components.schema=function(e,t,n){if(!t)return $.extend(!0,{},$cmanager.schemas[e]);if("object"==typeof t)return $cmanager.schemas[e]=t,t;if("function"==typeof t){var o=t();return $cmanager.schemas[e]=o,o}if("string"!=typeof t)return void 0;var r=t.substring(0,1),a=t.substring(t.length-1);if('"'===r&&'"'===a||"["===r&&"]"===a||"{"===r&&"}"===a){var c=JSON.parse(t);return $cmanager.schemas[e]=c,n&&n(c),c}$.get($components_url(t),function(t){"string"==typeof t&&(t=JSON.parse(t)),$cmanager.schemas[e]=t,n&&n(t)})},$.components.each=function(e,t,n,o){var r=t?-1!==t.lastIndexOf("*"):!1;r&&(t=t.replace(".*","").replace("*",""));for(var a=0,c=0,i=$cmanager.components.length;i>c;c++){var s=$cmanager.components[c];if(!(s.$removed||o&&s.path!==t)){if(t){if(!s.path)continue;if(r){if(0!==s.path.indexOf(t))continue}else if(t!==s.path){if(!n)continue;if(-1===t.indexOf(s.path))continue}}var p=e(s,a++,r);if(p===!0)return $.components}}return $.components},$.components.eachPath=function(e,t){var n=t?-1!==t.lastIndexOf("*"):!1;n&&(t=t.replace(".*","").replace("*",""));for(var o=0,r=0,a=$cmanager.components.length;a>r;r++){var c=$cmanager.components[r];!c.$removed&&c.path&&(n?(0!==t.indexOf(c.path)||c.path.indexOf(t))&&e(c,o++,!0):0===t.indexOf(c.path)&&e(c,o++,!1))}return $.components},Component.prototype.setPath=function(e){var t=null;return 33===e.charCodeAt(0)&&(e=e.substring(1),t=e),this.path=e,this.$path=t,this.$$path=e.split("."),this},Component.prototype.attr=function(e,t){return void 0===t?this.element.attr(e):(this.element.attr(e,t),this)},Component.prototype.html=function(e){return void 0===e?this.element.html():this.element.html(e)},Component.prototype.isInvalid=function(){var e=!this.$valid;return e&&!this.$validate&&(e=!this.$dirty),e},Component.prototype.watch=function(e,t,n){var o=this;return"function"==typeof e&&(n=t,t=e,e=o.path),o.on("watch",e,t),n?(setTimeout(function(){t.call(o,e,o.get())},5),o):o},Component.prototype.invalid=function(){return this.valid(!1).dirty(!1)},Component.prototype.valid=function(e,t){return void 0===e?this.$valid:(this.$valid=e,this.$validate=!1,$cmanager.clear("valid"),t?this:(this.state&&this.state(1,1),this))},Component.prototype.style=function(e){return STYLE(e),this},Component.prototype.change=function(e){return void 0===e?!this.dirty():this.dirty(!e)},Component.prototype.dirty=function(e,t){return void 0===e?this.$dirty:(this.$dirty=e,$cmanager.clear("dirty"),t?this:(this.state&&this.state(2,2),this))},Component.prototype.reset=function(e){return this.dirty(!1,e),this.valid(!1,e),this},Component.prototype.remove=function(e){this.destroy&&this.destroy(),this.element.removeData(COM_ATTR),this.element.find(COM_ATTR).attr(COM_ATTR_R,"true"),this.element.attr(COM_ATTR_R,"true"),e||$cmanager.clear(),$.components.$removed=!0,$.components.$emit("destroy",this.name,this.element.attr(COM_ATTR_P)),e?$cmanager.refresh():$cmanager.cleaner()},Component.prototype.on=function(e,t,n,o){"function"==typeof t?(o=n,n=t,t=this.path):t=t.replace(".*","");var r=null;return 33===t.charCodeAt(0)&&(t=t.substring(1),r=t),$cmanager.events[t]?$cmanager.events[t][e]||($cmanager.events[t][e]=[]):($cmanager.events[t]={},$cmanager.events[t][e]=[]),$cmanager.events[t][e].push({fn:n,context:this,id:this._id,path:r}),o?(n.call($.components,t,$cmanager.get(t)),this):$.components},Component.prototype.formatter=function(e){if("function"==typeof e)return this.$formatter||(this.$formatter=[]),this.$formatter.push(e),this;var t=this.$formatter;if(t&&t.length)for(var n=0,o=t.length;o>n;n++)e=t[n].call(this,this.path,e,this.type);if(t=$.components.$formatter,t&&t.length)for(var n=0,o=t.length;o>n;n++)e=t[n].call(this,this.path,e,this.type);return e},Component.prototype.parser=function(e){if("function"==typeof e)return this.$parser||(this.$parser=[]),this.$parser.push(e),this;var t=this.$parser;if(t&&t.length)for(var n=0,o=t.length;o>n;n++)e=t[n].call(this,this.path,e,this.type);if(t=$.components.$parser,t&&t.length)for(var n=0,o=t.length;o>n;n++)e=t[n].call(this,this.path,e,this.type);return e},Component.prototype.emit=function(){$.components.emit.apply($.components,arguments)},Component.prototype.evaluate=function(e,t){return t||(e=self.path),$.components.evaluate(e,t)},Component.prototype.get=function(e){return e||(e=this.path),e?($.components.debug&&console.log("%c$.components.get("+e+")","color:gray"),$cmanager.get(e)):void 0},Component.prototype.update=function(e,t){$.components.update(e||this.path,t)},Component.prototype.set=function(e,t,n){var o=this;return void 0===t&&(t=e,e=this.path),e?($.components.set(e,t,n),o):o},Component.prototype.inc=function(e,t){var n=this;return void 0===t&&(t=e,e=this.path),e?($.components.inc(e,t),n):n},Component.prototype.extend=function(e,t,n){var o=this;return void 0===t&&(t=e,e=this.path),e?($.components.extend(e,t,n),o):o},Component.prototype.push=function(e,t,n){var o=this;return void 0===t&&(t=e,e=this.path),e?void $.components.push(e,t,n,o):o},ComponentManager.prototype.cacherest=function(e,t,n,o,r){n&&!n.version&&$.components.$version&&(n.version=$.components.$version),n&&!n.language&&$.components.$language&&(n.language=$.components.$language),n=JSON.stringify(n);var a=$components_hash(e+"#"+t.replace(/\//g,"")+n).toString();return this.cachestorage(a,o,r)},ComponentManager.prototype.cachestorage=function(e,t,n){var o=Date.now();if($.components.debug&&console.log("%c$.components.cache."+(void 0===t?"get":"set")+"("+e+")","color:silver"),void 0!==t)return this.storage[e]={expire:o+n,value:t},void $components_save();var r=this.storage[e];return r&&r.expire>o?r.value:void 0},ComponentManager.prototype.initialize=function(){var e=this.init.pop();return void 0===e?($.components.compile(),this):(e.$removed||this.prepare(e),this.initialize(),this)},ComponentManager.prototype.remap=function(e,t){var n=e.indexOf("->");if(-1===n)return $.components.set(e,t);var o=e.substring(0,n).trim(),r=e.substring(n+2).trim();return $.components.set(r,t[o]),this},ComponentManager.prototype.prepare=function(e){if(!e)return this;var t=e.get(),n=e.element;e.setter&&(e.$ready||(e.setter(t,e.path),e.$ready=!0)),e.validate&&(e.$valid=e.validate(e.get(),!0)),e.done&&setTimeout(function(){e.done()},20),e.state&&e.state(0,3),e.$init&&setTimeout(function(){if($cmanager.isOperation(e.$init)){var t=OPERATION(e.$init);return t?t.call(e,e):console&&console.warn("Operation "+e.$init+" not found."),void delete e.$init}var n=$.components.get(e.$init);"function"==typeof n&&n.call(e,e),delete e.$init},2),n.trigger("component"),n.off("component");var o=n.attr(COM_ATTR_C);if(o){o=o.split(" ");for(var r=0,a=o.length;a>r;r++)n.toggleClass(o[r])}return e.id&&$.components.emit("#"+e.id,e),$.components.emit("@"+e.name,e),$.components.emit("component",e),this},ComponentManager.prototype.next=function(){var e=this.pending.shift();return void 0===e?(this.isReady&&(this.isCompiling=!1),this):void e()},ComponentManager.prototype.clear=function(){var e=this;if(0===arguments.length)return e.cache={},e;for(var t=Object.keys(e.cache),n=0,o=t.length;o>n;n++){for(var r=t[n],a=!1,c=0;c<arguments.length;c++)if(r.substring(0,arguments[c].length)===arguments[c]){a=!0;break}a&&delete e.cache[r]}return e},ComponentManager.prototype.refresh=function(){var e=this;return e.components=[],$(COM_ATTR).each(function(){var t=$(this).data(COM_ATTR);t&&t.element&&e.components.push(t)}),e},ComponentManager.prototype.isArray=function(e){var t=e.lastIndexOf("[");return-1===t?!1:(e=e.substring(t+1,e.length-1).substring(0,1),'"'===e||"'"===e?!1:!0)},ComponentManager.prototype.isOperation=function(e){return 35===e.charCodeAt(0)?!0:!1},ComponentManager.prototype.get=function(e){if(35===e.charCodeAt(0)){var t=OPERATION(e);return t?t:(console&&console.warn("Operation "+e.substring(1)+" not found."),function(){})}var n="="+e,o=this;if(o.temp[n])return o.temp[n](window);for(var r=e.split("."),a=[],c="",i=0,s=r.length-1;s>i;i++)c+=(""!==c?".":"")+r[i],a.push("if(!w."+c+")return");var p=new Function("w",a.join(";")+";return w."+e.replace(/\'/,"'"));return o.temp[n]=p,p(window)},ComponentManager.prototype.set=function(e,t){if(35===e.charCodeAt(0)){var n=OPERATION(e);
return n?n(t,e):console&&console.warn("Operation "+e+" not found."),r}var o="+"+e,r=this;if(r.temp[o])return r.cache[o](window,t);for(var a=e.split("."),c=[],i="",s=0,p=a.length;p>s;s++){i+=(""!==i?".":"")+a[s];var m=r.isArray(a[s])?"[]":"{}";{if(s===p-1){if("{}"===m)break;i=i.substring(0,i.lastIndexOf("[")),c.push("if(!(w."+i+" instanceof Array))w."+i+"="+m);break}c.push("if(typeof(w."+i+')!=="object")w.'+i+"="+m)}}var u=new Function("w","a","b",c.join(";")+";var v=typeof(a) === 'function' ? a($cmanager.get(b)) : a;w."+e.replace(/\'/,"'")+"=v;return v");return r.cache[o]=u,u(window,t,e),r},$.components.inc=function(e,t){var n=$.components.get(e);return n?"number"!=typeof n&&(n=parseFloat(n),isNaN(n)&&(n=0)):n=0,n+=t,$.components.set(e,t,type),self},ComponentManager.prototype.cleaner=function(){for(var e=this,t=Object.keys(e.events),n=!1,o=0,r=t.length;r>o;o++){var a=t[o];if(e.events[a])for(var c=Object.keys(e.events[a]),i=0,s=c.length;s>i;i++){var p=c[i],m=e.events[a][p];if(m)for(var u=0;;){var l=m[u++];if(void 0===l)break;void 0!==l.context&&(null===l.context||l.context.element&&l.context.element.closest(document.documentElement)||(l.context&&l.context.element&&l.context.element.remove(),l.context.$removed=!0,l.context=null,e.events[a][p].splice(u-1,1),0===e.events[a][p].length&&(delete e.events[a][p],0===Object.keys(e.events[a]).length&&delete e.events[a]),u-=2,n=!0))}}}for(var u=0;;){var f=$cmanager.components[u++];if(!f)break;f.attr(COM_ATTR_R)?(f.element.remove(),f.element=null,f.path=null,f.setter=null,f.getter=null,$cmanager.components.splice(u-1,1),u=-1):(f.$parser&&!f.$parser.length&&delete f.$parser,f.$formatter&&!f.$formatter.length&&delete f.$formatter)}var h=Date.now(),d=!1,g=!1;for(var v in e.cacheblocked)e.cacheblocked[v]>h||(delete e.cacheblocked[v],d=!0);$.components.defaults.localstorage&&d&&localStorage.setItem($.components.$localstorage+".blocked",JSON.stringify(e.cacheblocked));for(var v in e.storage){var l=e.storage[v];(!l.expire||l.expire<=h)&&(delete e.storage[v],g=!0)}return g&&$components_save(),n&&e.refresh(),e},COMPONENT("",function(){this.make=function(){var e=this.element.get(0).tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e?(this.getter=null,void(this.setter=function(e){e=this.formatter(e,!0),this.element.html(e)})):(this.element.attr(COM_ATTR_B)||this.element.attr(COM_ATTR_B,this.path),void(this.element.$component=this))}}),setInterval(function(){$cmanager.cleaner()},6e4),setInterval(function(){$cmanager.temp={}},3e5),$.components.compile(),$(document).ready(function(){if($.components.defaults.localstorage){var e=localStorage.getItem($.components.$localstorage+".cache");if(e&&"string"==typeof e)try{$cmanager.storage=JSON.parse(e)}catch(t){}if(e=localStorage.getItem($.components.$localstorage+".blocked"),e&&"string"==typeof e)try{$cmanager.cacheblocked=JSON.parse(e)}catch(t){}}$(document).on("change keypress keydown blur focus","input[data-component-bind],textarea[data-component-bind],select[data-component-bind]",function(e){var t=this;if("keypress"!==e.type){var n="checkbox"===t.type||"radio"===t.type||"SELECT"===t.tagName;if(("focusin"!==e.type&&"focusout"!==e.type||!n)&&"focusin"!==e.type&&("change"!==e.type||n)&&t.$component&&!t.$component.$removed&&t.$component.getter&&t.$component.setter&&9!==e.keyCode&&(8!==e.keyCode||t.value)){if(t.$skip&&"focusout"===e.type)return void $components_keypress(t,t.$value,e);var o,r=t.$value;if(t.$value=null,"checkbox"===t.type||"radio"===t.type){if("keydown"===e.type)return;var o=t.checked;return t.$component.dirty(!1,!0),t.$component.getter(o,2),void(t.$component.$skip=!1)}if("SELECT"===t.tagName){if("keydown"===e.type)return;var a=t[t.selectedIndex];return o=a.value,t.$component.dirty(!1,!0),t.$component.getter(o,2),void(t.$component.$skip=!1)}if(void 0===t.$delay&&(t.$delay=parseInt(t.getAttribute("data-component-keypress-delay")||"0")),void 0===t.$only&&(t.$only="true"===t.getAttribute("data-component-keypress-only")),(!t.$only||"focusout"!==e.type&&"change"!==e.type)&&("keydown"!==e.type||void 0!==e.keyCode&&9!==e.keyCode)){if(e.keyCode<41&&8!==e.keyCode&&32!==e.keyCode){if(13!==e.keyCode)return;if("TEXTAREA"!==e.tagName)return t.$value=t.value,clearTimeout(t.$timeout),void $components_keypress(t,r,e)}if(void 0===t.$nokeypress){var c=t.getAttribute("data-component-keypress");t.$nokeypress=c?"false"===c:$.components.defaults.keypress===!1}var i=t.$delay;if(t.$nokeypress){if("keydown"===e.type||"focusout"===e.type)return;0===i&&(i=1)}else 0===i&&(i=$.components.defaults.delay);"focusout"===e.type&&(i=0),clearTimeout(t.$timeout),t.$timeout=setTimeout(function(){$components_keypress(t,r,e)},i)}}}else if("TEXTAREA"!==t.tagName&&13===e.keyCode)return!1}),setTimeout(function(){$.components.compile()},2),setTimeout(function(){$cmanager.cleaner()},3e3)});